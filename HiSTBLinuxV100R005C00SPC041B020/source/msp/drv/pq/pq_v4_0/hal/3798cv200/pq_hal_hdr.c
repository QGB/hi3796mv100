/******************************************************************************
*
* Copyright (C) 2016 Hisilicon Technologies Co., Ltd.  All rights reserved.
*
* This program is confidential and proprietary to Hisilicon  Technologies Co., Ltd. (Hisilicon),
*  and may not be copied, reproduced, modified, disclosed to others, published or used, in
* whole or in part, without the express prior written permission of Hisilicon.
*
*****************************************************************************

  File Name    : pq_hal_hdr.c
  Version       : Initial Draft
  Author        : w00357637
                      p00203646
  Created      : 2016/06/15
  Description  :

******************************************************************************/
#include <linux/string.h>

#include "hi_type.h"
#include "hi_math.h"

#include "pq_hal_comm.h"
#include "pq_hal_hdr.h"
#include "pq_mng_hdr_alg.h"

static PQ_PARAM_S* sg_pstHalHdrPqParam = HI_NULL;
static PQ_HDR_ALG_TM sg_stHdrCfg;
static PQ_HAL_HDR_MODE_E sg_enHDRMode = PQ_HAL_HDR_MODE_HDR10_TO_SDR;
static HI_S16 sg_aSMLutI[PQ_HAL_HDR_MODE_BUTT][PQ_HAL_HDR_TM_LUT_SIZE];


static const HI_S16 as16Hlg2SDRTMLutI[PQ_HAL_HDR_TM_LUT_SIZE] =
{
    0	, 11  , 21	, 32  , 41	, 51  , 61	, 70  , 80	, 89  , 99	, 108 , 117	, 127 , 136	, 145 ,
    154	, 163 , 172	, 181 , 190	, 199 , 208	, 217 , 226	, 235 , 244	, 253 , 262	, 271 , 279	, 288 ,
    297	, 306 , 315	, 323 , 332	, 341 , 349	, 358 , 367	, 376 , 384	, 393 , 402	, 410 , 419	, 427 ,
    436	, 445 , 453	, 462 , 470	, 479 , 487	, 496 , 505	, 513 , 522	, 530 , 539	, 547 , 556	, 564 ,
    573	, 581 , 589	, 598 , 606	, 615 , 623	, 632 , 640	, 649 , 657	, 665 , 674	, 682 , 691	, 699 ,
    707	, 716 , 724	, 732 , 741	, 749 , 757	, 766 , 774	, 782 , 791	, 799 , 807	, 816 , 824	, 832 ,
    841	, 849 , 857	, 865 , 874	, 882 , 890	, 899 , 907	, 915 , 923	, 932 , 940	, 948 , 956	, 965 ,
    973	, 981 , 989	, 997 , 1006, 1014, 1022, 1030, 1038, 1047, 1055, 1063, 1071, 1079, 1088, 1096,

    1104, 1112, 1120, 1128, 1137, 1145, 1153, 1161, 1169, 1177, 1185, 1194, 1202, 1210, 1218, 1226,
    1234, 1242, 1250, 1259, 1267, 1275, 1283, 1291, 1299, 1307, 1315, 1323, 1331, 1339, 1348, 1356,
    1364, 1372, 1380, 1388, 1396, 1404, 1412, 1420, 1428, 1436, 1444, 1452, 1460, 1468, 1476, 1484,
    1493, 1501, 1509, 1517, 1525, 1533, 1541, 1549, 1557, 1565, 1573, 1581, 1589, 1597, 1605, 1613,
    1621, 1629, 1637, 1645, 1653, 1661, 1669, 1677, 1685, 1693, 1701, 1709, 1717, 1724, 1732, 1740,
    1748, 1756, 1764, 1772, 1780, 1788, 1796, 1804, 1812, 1820, 1828, 1836, 1844, 1852, 1860, 1868,
    1876, 1883, 1891, 1899, 1907, 1915, 1923, 1931, 1939, 1947, 1955, 1963, 1971, 1978, 1986, 1994,
    2002, 2010, 2018, 2026, 2034, 2042, 2050, 2057, 2065, 2073, 2081, 2089, 2097, 2105, 2113, 2120,

    2128, 2136, 2144, 2152, 2160, 2168, 2176, 2183, 2191, 2199, 2207, 2215, 2223, 2231, 2238, 2246,
    2254, 2262, 2270, 2278, 2286, 2293, 2301, 2309, 2317, 2325, 2333, 2340, 2348, 2356, 2364, 2372,
    2380, 2387, 2395, 2403, 2411, 2419, 2426, 2434, 2442, 2450, 2458, 2466, 2473, 2481, 2489, 2497,
    2505, 2512, 2520, 2528, 2536, 2544, 2551, 2559, 2567, 2575, 2583, 2590, 2598, 2606, 2614, 2621,
    2629, 2637, 2645, 2653, 2660, 2668, 2676, 2684, 2691, 2699, 2707, 2715, 2723, 2730, 2738, 2746,
    2754, 2761, 2769, 2777, 2785, 2792, 2800, 2808, 2816, 2823, 2831, 2839, 2847, 2854, 2862, 2870,
    2878, 2885, 2893, 2901, 2909, 2916, 2924, 2932, 2940, 2947, 2955, 2963, 2970, 2978, 2986, 2994,
    3001, 3009, 3017, 3025, 3032, 3040, 3048, 3055, 3063, 3071, 3079, 3086, 3094, 3102, 3109, 3117,

    3125, 3133, 3140, 3148, 3156, 3163, 3171, 3179, 3186, 3194, 3202, 3210, 3217, 3225, 3233, 3240,
    3248, 3256, 3263, 3271, 3279, 3286, 3294, 3302, 3310, 3317, 3325, 3333, 3340, 3348, 3356, 3363,
    3371, 3379, 3386, 3394, 3402, 3409, 3417, 3425, 3432, 3440, 3448, 3455, 3463, 3471, 3478, 3486,
    3494, 3501, 3509, 3517, 3524, 3532, 3540, 3547, 3555, 3563, 3570, 3578, 3585, 3593, 3601, 3608,
    3616, 3624, 3631, 3639, 3647, 3654, 3662, 3670, 3677, 3685, 3692, 3700, 3708, 3715, 3723, 3731,
    3738, 3746, 3754, 3761, 3769, 3776, 3784, 3792, 3799, 3807, 3815, 3822, 3830, 3837, 3845, 3853,
    3860, 3868, 3875, 3883, 3891, 3898, 3906, 3914, 3921, 3929, 3936, 3944, 3952, 3959, 3967, 3974,
    3982, 3990, 3997, 4005, 4012, 4020, 4028, 4035, 4043, 4050, 4058, 4066, 4073, 4081, 4088, 4095
};

static const HI_S16 as16Hlg2SDRTMLutS[PQ_HAL_HDR_TM_LUT_SIZE] =
{
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095
};


static const HI_S16 as16Hlg2SDRSMLutI[PQ_HAL_HDR_TM_LUT_SIZE] =
{
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095
};

static const HI_S16 as16Hlg2SDRSMLutS[PQ_HAL_HDR_TM_LUT_SIZE] =
{
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095
};


/* HLG to HDR10 */
static const HI_S16 as16Hlg2HDR10TMLutI[PQ_HAL_HDR_TM_LUT_SIZE] =
{
    0   , 2   , 5   , 9   , 12  , 16  , 20  , 24  , 28  , 32  , 36  , 41  , 45  , 50  , 55  , 59  ,
    64  , 69  , 74  , 79  , 84  , 89  , 94  , 99  , 104 , 110 , 115 , 120 , 126 , 131 , 136 , 142 ,
    147 , 153 , 159 , 164 , 170 , 175 , 181 , 187 , 193 , 198 , 204 , 210 , 216 , 222 , 228 , 234 ,
    240 , 246 , 252 , 258 , 264 , 270 , 276 , 282 , 288 , 295 , 301 , 307 , 313 , 320 , 326 , 332 ,
    339 , 345 , 351 , 358 , 364 , 371 , 377 , 383 , 390 , 396 , 403 , 410 , 416 , 423 , 429 , 436 ,
    443 , 449 , 456 , 463 , 469 , 476 , 483 , 489 , 496 , 503 , 510 , 517 , 523 , 530 , 537 , 544 ,
    551 , 558 , 565 , 572 , 578 , 585 , 592 , 599 , 606 , 613 , 620 , 627 , 634 , 641 , 649 , 656 ,
    663 , 670 , 677 , 684 , 691 , 698 , 706 , 713 , 720 , 727 , 734 , 742 , 749 , 756 , 763 , 771 ,

    778 , 785 , 792 , 800 , 807 , 814 , 822 , 829 , 837 , 844 , 851 , 859 , 866 , 874 , 881 , 889 ,
    896 , 903 , 911 , 918 , 926 , 933 , 941 , 948 , 956 , 964 , 971 , 979 , 986 , 994 , 1001, 1009,
    1017, 1024, 1032, 1040, 1047, 1055, 1063, 1070, 1078, 1086, 1093, 1101, 1109, 1117, 1124, 1132,
    1140, 1148, 1155, 1163, 1171, 1179, 1187, 1195, 1202, 1210, 1218, 1226, 1234, 1242, 1250, 1257,
    1265, 1273, 1281, 1289, 1297, 1305, 1313, 1321, 1329, 1337, 1345, 1353, 1361, 1369, 1377, 1385,
    1393, 1401, 1409, 1417, 1425, 1433, 1441, 1449, 1457, 1466, 1474, 1482, 1490, 1498, 1506, 1514,
    1522, 1531, 1539, 1547, 1555, 1563, 1572, 1580, 1588, 1596, 1604, 1613, 1621, 1629, 1637, 1646,
    1654, 1662, 1670, 1679, 1687, 1695, 1704, 1712, 1720, 1729, 1737, 1745, 1754, 1762, 1770, 1779,

    1787, 1795, 1804, 1812, 1821, 1829, 1837, 1846, 1854, 1863, 1871, 1880, 1888, 1897, 1905, 1913,
    1922, 1930, 1939, 1947, 1956, 1964, 1973, 1981, 1990, 1998, 2007, 2016, 2024, 2033, 2041, 2050,
    2058, 2067, 2076, 2084, 2093, 2101, 2110, 2119, 2127, 2136, 2144, 2153, 2162, 2170, 2179, 2188,
    2196, 2205, 2214, 2222, 2231, 2240, 2248, 2257, 2266, 2275, 2283, 2292, 2301, 2310, 2318, 2327,
    2336, 2345, 2353, 2362, 2371, 2380, 2388, 2397, 2406, 2415, 2424, 2432, 2441, 2450, 2459, 2468,
    2477, 2485, 2494, 2503, 2512, 2521, 2530, 2539, 2548, 2556, 2565, 2574, 2583, 2592, 2601, 2610,
    2619, 2628, 2637, 2646, 2655, 2664, 2672, 2681, 2690, 2699, 2708, 2717, 2726, 2735, 2744, 2753,
    2762, 2771, 2780, 2789, 2798, 2807, 2816, 2825, 2835, 2844, 2853, 2862, 2871, 2880, 2889, 2898,

    2907, 2916, 2925, 2934, 2943, 2953, 2962, 2971, 2980, 2989, 2998, 3007, 3016, 3026, 3035, 3044,
    3053, 3062, 3071, 3080, 3090, 3099, 3108, 3117, 3126, 3136, 3145, 3154, 3163, 3172, 3182, 3191,
    3200, 3209, 3219, 3228, 3237, 3246, 3256, 3265, 3274, 3283, 3293, 3302, 3311, 3321, 3330, 3339,
    3348, 3358, 3367, 3376, 3386, 3395, 3404, 3414, 3423, 3432, 3442, 3451, 3460, 3470, 3479, 3488,
    3498, 3507, 3516, 3526, 3535, 3545, 3554, 3563, 3573, 3582, 3592, 3601, 3610, 3620, 3629, 3639,
    3648, 3658, 3667, 3677, 3686, 3695, 3705, 3714, 3724, 3733, 3743, 3752, 3762, 3771, 3781, 3790,
    3800, 3809, 3819, 3828, 3838, 3847, 3857, 3866, 3876, 3885, 3895, 3904, 3914, 3923, 3933, 3943,
    3952, 3962, 3971, 3981, 3990, 4000, 4010, 4019, 4029, 4038, 4048, 4058, 4067, 4077, 4086, 4095
};

static const HI_S16 as16Hlg2HDR10TMLutS[PQ_HAL_HDR_TM_LUT_SIZE] =
{
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095
};


static const HI_S16 as16Hlg2HDR10SMLutI[PQ_HAL_HDR_TM_LUT_SIZE] =
{
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095
};

static const HI_S16 as16Hlg2HDR10SMLutS[PQ_HAL_HDR_TM_LUT_SIZE] =
{
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,

    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
    4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095
};

static HI_S32 pq_hal_GetHDRDefaultCfg(PQ_HDR_ALG_TM* pstHdrDefaultCfg)
{
    PQ_CHECK_NULL_PTR(pstHdrDefaultCfg);

    memcpy(pstHdrDefaultCfg->as16HLGtoSDRTMLut[PQ_HAL_HDR_TM_TMLUTI], as16Hlg2SDRTMLutI, sizeof(as16Hlg2SDRTMLutI));
    memcpy(pstHdrDefaultCfg->as16HLGtoSDRTMLut[PQ_HAL_HDR_TM_TMLUTS], as16Hlg2SDRTMLutS, sizeof(as16Hlg2SDRTMLutS));
    memcpy(pstHdrDefaultCfg->as16HLGtoSDRTMLut[PQ_HAL_HDR_TM_SMLUTI], as16Hlg2SDRSMLutI, sizeof(as16Hlg2SDRSMLutI));
    memcpy(pstHdrDefaultCfg->as16HLGtoSDRTMLut[PQ_HAL_HDR_TM_SMLUTS], as16Hlg2SDRSMLutS, sizeof(as16Hlg2SDRSMLutS));

    memcpy(pstHdrDefaultCfg->as16HLGtoHDR10TMLut[PQ_HAL_HDR_TM_TMLUTI], as16Hlg2HDR10TMLutI, sizeof(as16Hlg2HDR10TMLutI));
    memcpy(pstHdrDefaultCfg->as16HLGtoHDR10TMLut[PQ_HAL_HDR_TM_TMLUTS], as16Hlg2HDR10TMLutS, sizeof(as16Hlg2HDR10TMLutS));
    memcpy(pstHdrDefaultCfg->as16HLGtoHDR10TMLut[PQ_HAL_HDR_TM_SMLUTI], as16Hlg2HDR10SMLutI, sizeof(as16Hlg2HDR10SMLutI));
    memcpy(pstHdrDefaultCfg->as16HLGtoHDR10TMLut[PQ_HAL_HDR_TM_SMLUTS], as16Hlg2HDR10SMLutS, sizeof(as16Hlg2HDR10SMLutS));

    return HI_SUCCESS;
}

static HI_S32 pq_hal_GetHDR10toHDR10Cfg(HI_PQ_HDR_CFG* pstPqHdrCfg)
{
    return HI_SUCCESS;
}

static HI_S32 pq_hal_GetHDR10toSDRCfg(HI_PQ_HDR_CFG* pstPqHdrCfg)
{
    memcpy((HI_VOID*) & (pstPqHdrCfg->stPQHdrTm), (HI_VOID*)(sg_stHdrCfg.as16HDR10toSDRTMLut), sizeof(HI_PQ_HDR_TM));
    return HI_SUCCESS;
}

static HI_S32 pq_hal_GetHLGtoSDRCfg(HI_PQ_HDR_CFG* pstPqHdrCfg)
{
    memcpy((HI_VOID*) & (pstPqHdrCfg->stPQHdrTm), (HI_VOID*)(sg_stHdrCfg.as16HLGtoSDRTMLut), sizeof(HI_PQ_HDR_TM));
    return HI_SUCCESS;
}

static HI_S32 pq_hal_GetHLGtoHDR10Cfg(HI_PQ_HDR_CFG* pstPqHdrCfg)
{
    memcpy((HI_VOID*) & (pstPqHdrCfg->stPQHdrTm), (HI_VOID*)(sg_stHdrCfg.as16HLGtoHDR10TMLut), sizeof(HI_PQ_HDR_TM));
    return HI_SUCCESS;
}

HI_S32 PQ_HAL_GetHDRCfg(HI_PQ_WIN_HDR_INFO* pstWinHdrInfo, HI_PQ_HDR_CFG* pstPqHdrCfg)
{
    HI_S32 s32Ret = HI_FAILURE;

    PQ_CHECK_NULL_PTR(pstWinHdrInfo);
    PQ_CHECK_NULL_PTR(pstPqHdrCfg);

    if ( (HI_DRV_VIDEO_FRAME_TYPE_HDR10 == pstWinHdrInfo->enSrcFrameType)
         && (HI_PQ_DISP_TYPE_HDR10 == pstWinHdrInfo->enDispType) )
    {
        sg_enHDRMode = PQ_HAL_HDR_MODE_HDR10_TO_HDR10;
        s32Ret = pq_hal_GetHDR10toHDR10Cfg(pstPqHdrCfg);
    }
    else if ( (HI_DRV_VIDEO_FRAME_TYPE_HDR10 == pstWinHdrInfo->enSrcFrameType)
              && (HI_PQ_DISP_TYPE_NORMAL == pstWinHdrInfo->enDispType) )
    {
        sg_enHDRMode = PQ_HAL_HDR_MODE_HDR10_TO_SDR;
        s32Ret = pq_hal_GetHDR10toSDRCfg(pstPqHdrCfg);
    }
    else if ( (HI_DRV_VIDEO_FRAME_TYPE_HLG == pstWinHdrInfo->enSrcFrameType)
              && (HI_PQ_DISP_TYPE_NORMAL == pstWinHdrInfo->enDispType) )
    {
        sg_enHDRMode = PQ_HAL_HDR_MODE_HLG_TO_SDR;
        s32Ret = pq_hal_GetHLGtoSDRCfg(pstPqHdrCfg);
    }
    else if ( (HI_DRV_VIDEO_FRAME_TYPE_HLG == pstWinHdrInfo->enSrcFrameType)
              && (HI_PQ_DISP_TYPE_HDR10 == pstWinHdrInfo->enDispType) )
    {
        sg_enHDRMode = PQ_HAL_HDR_MODE_HLG_TO_HDR10;
        s32Ret = pq_hal_GetHLGtoHDR10Cfg(pstPqHdrCfg);
    }

    return s32Ret;
}

static HI_VOID pq_hal_SetHDRPqParamDefault(HI_VOID)
{
    if (HI_NULL == sg_pstHalHdrPqParam)
    {
        return;
    }

    memcpy(sg_pstHalHdrPqParam->stPQCoef.stHdrTmCoef.as16TMLut, &sg_stHdrCfg, sizeof(sg_stHdrCfg));
    return ;
}

static HI_VOID pq_hal_GetSMLutI(PQ_HDR_ALG_TM* pstHdrCfg)
{
    if (HI_NULL == pstHdrCfg)
    {
        return;
    }

    memcpy(sg_aSMLutI[PQ_HAL_HDR_MODE_HDR10_TO_SDR],
           pstHdrCfg->as16HDR10toSDRTMLut[PQ_HAL_HDR_TM_SMLUTI], sizeof(HI_S16)*PQ_HAL_HDR_TM_LUT_SIZE);
    memcpy(sg_aSMLutI[PQ_HAL_HDR_MODE_HLG_TO_SDR],
           pstHdrCfg->as16HLGtoSDRTMLut[PQ_HAL_HDR_TM_SMLUTI], sizeof(HI_S16)*PQ_HAL_HDR_TM_LUT_SIZE);
    memcpy(sg_aSMLutI[PQ_HAL_HDR_MODE_HLG_TO_HDR10],
           pstHdrCfg->as16HLGtoHDR10TMLut[PQ_HAL_HDR_TM_SMLUTI], sizeof(HI_S16)*PQ_HAL_HDR_TM_LUT_SIZE);

    return ;
}

HI_S32 PQ_HAL_SetHDRSaturation(HI_U32 u32Saturation)
{
    HI_S32 i = 0;
    HI_S32 s32Gain = 0;

    s32Gain = (HI_S32)u32Saturation - 50;
    for (i = 0; i < PQ_HAL_HDR_TM_LUT_SIZE; i++)
    {
        sg_stHdrCfg.as16HDR10toSDRTMLut[PQ_HAL_HDR_TM_SMLUTI][i]
            = sg_aSMLutI[PQ_HAL_HDR_MODE_HDR10_TO_SDR][i] + sg_aSMLutI[PQ_HAL_HDR_MODE_HDR10_TO_SDR][i] * s32Gain / 50;
        sg_stHdrCfg.as16HDR10toSDRTMLut[PQ_HAL_HDR_TM_SMLUTI][i]
            = CLIP3(sg_stHdrCfg.as16HDR10toSDRTMLut[PQ_HAL_HDR_TM_SMLUTI][i], 0, 4095);

        sg_stHdrCfg.as16HLGtoSDRTMLut[PQ_HAL_HDR_TM_SMLUTI][i]
            = sg_aSMLutI[PQ_HAL_HDR_MODE_HLG_TO_SDR][i] + sg_aSMLutI[PQ_HAL_HDR_MODE_HLG_TO_SDR][i] * s32Gain / 50;
        sg_stHdrCfg.as16HLGtoSDRTMLut[PQ_HAL_HDR_TM_SMLUTI][i]
            = CLIP3(sg_stHdrCfg.as16HLGtoSDRTMLut[PQ_HAL_HDR_TM_SMLUTI][i], 0, 4095);

        sg_stHdrCfg.as16HLGtoHDR10TMLut[PQ_HAL_HDR_TM_SMLUTI][i]
            = sg_aSMLutI[PQ_HAL_HDR_MODE_HLG_TO_HDR10][i] + sg_aSMLutI[PQ_HAL_HDR_MODE_HLG_TO_HDR10][i] * s32Gain / 50;
        sg_stHdrCfg.as16HLGtoHDR10TMLut[PQ_HAL_HDR_TM_SMLUTI][i]
            = CLIP3(sg_stHdrCfg.as16HLGtoHDR10TMLut[PQ_HAL_HDR_TM_SMLUTI][i], 0, 4095);
    }

    return HI_SUCCESS;
}

HI_S32 PQ_HAL_InitHDR(PQ_PARAM_S* pstPqParam, HI_BOOL bDefault)
{
    HI_U32 u32HdrSaturation   = 50;

    sg_pstHalHdrPqParam = pstPqParam;

    PQ_CHECK_NULL_PTR(sg_pstHalHdrPqParam);

    memset(&sg_stHdrCfg, 0, sizeof(sg_stHdrCfg));
    memset(sg_aSMLutI, 0, sizeof(sg_aSMLutI));

    if (HI_TRUE == bDefault)
    {
        PQ_MNG_DescrambleHdrCfg(PQ_HDR_ALG_CFG_TYPE_TM, &sg_stHdrCfg);
        pq_hal_SetHDRPqParamDefault();
    }
    else
    {
        memcpy(&sg_stHdrCfg, sg_pstHalHdrPqParam->stPQCoef.stHdrTmCoef.as16TMLut, sizeof(sg_stHdrCfg));
    }

    pq_hal_GetHDRDefaultCfg(&sg_stHdrCfg);
    pq_hal_GetSMLutI(&sg_stHdrCfg);
    PQ_HAL_SetHDRSaturation(u32HdrSaturation);

    return HI_SUCCESS;
}


static HI_S32 pq_hal_GetHDRCfgTmLut(HI_S16 (**pas16TMLut)[PQ_HAL_HDR_TM_LUT_SIZE],
                                    PQ_HAL_HDR_MODE_E enHDRMode)
{
    if (PQ_HAL_HDR_MODE_HDR10_TO_SDR == sg_enHDRMode)
    {
        *pas16TMLut =  sg_stHdrCfg.as16HDR10toSDRTMLut;
    }
    else if (PQ_HAL_HDR_MODE_HLG_TO_SDR == sg_enHDRMode)
    {
        *pas16TMLut =  sg_stHdrCfg.as16HLGtoSDRTMLut;
    }
    else if (PQ_HAL_HDR_MODE_HLG_TO_HDR10 == sg_enHDRMode)
    {
        *pas16TMLut =  sg_stHdrCfg.as16HLGtoHDR10TMLut;
    }
    else
    {
        *pas16TMLut = HI_NULL;
        return HI_FAILURE;
    }

    return HI_SUCCESS;
}

HI_S32 PQ_HAL_SetHDRTmLut(HI_PQ_HDR_TM_LUT_S* pstTMSetLut)
{
    HI_U32 u32LutSize = sizeof(HI_S16) * PQ_HAL_HDR_TM_LUT_SIZE;
    HI_S16 (*pas16TMLut)[PQ_HAL_HDR_TM_LUT_SIZE];

    pq_hal_GetHDRCfgTmLut(&pas16TMLut, sg_enHDRMode);

    PQ_CHECK_NULL_PTR(pstTMSetLut);
    PQ_CHECK_NULL_PTR(pas16TMLut);

    memcpy((HI_VOID*) & (pas16TMLut[PQ_HAL_HDR_TM_TMLUTI]), (HI_VOID*)(pstTMSetLut->as16TMLutI), u32LutSize);
    memcpy((HI_VOID*) & (pas16TMLut[PQ_HAL_HDR_TM_TMLUTS]), (HI_VOID*)(pstTMSetLut->as16TMLutS), u32LutSize);
    memcpy((HI_VOID*) & (pas16TMLut[PQ_HAL_HDR_TM_SMLUTI]), (HI_VOID*)(pstTMSetLut->as16SMLutI), u32LutSize);
    memcpy((HI_VOID*) & (pas16TMLut[PQ_HAL_HDR_TM_SMLUTS]), (HI_VOID*)(pstTMSetLut->as16SMLutS), u32LutSize);

    pq_hal_SetHDRPqParamDefault();

    return HI_SUCCESS;
}

HI_S32 PQ_HAL_GetHDRTmLut(HI_PQ_HDR_TM_LUT_S* pstTMSetLut)
{
    HI_U32 u32LutSize = sizeof(HI_S16) * PQ_HAL_HDR_TM_LUT_SIZE;
    HI_S16 (*pas16TMLut)[PQ_HAL_HDR_TM_LUT_SIZE];

    pq_hal_GetHDRCfgTmLut(&pas16TMLut, sg_enHDRMode);

    PQ_CHECK_NULL_PTR(pstTMSetLut);
    PQ_CHECK_NULL_PTR(pas16TMLut);

    memcpy((HI_VOID*)(pstTMSetLut->as16TMLutI), (HI_VOID*) & (pas16TMLut[PQ_HAL_HDR_TM_TMLUTI]), u32LutSize);
    memcpy((HI_VOID*)(pstTMSetLut->as16TMLutS), (HI_VOID*) & (pas16TMLut[PQ_HAL_HDR_TM_TMLUTS]), u32LutSize);
    memcpy((HI_VOID*)(pstTMSetLut->as16SMLutI), (HI_VOID*) & (pas16TMLut[PQ_HAL_HDR_TM_SMLUTI]), u32LutSize);
    memcpy((HI_VOID*)(pstTMSetLut->as16SMLutS), (HI_VOID*) & (pas16TMLut[PQ_HAL_HDR_TM_SMLUTS]), u32LutSize);

    return HI_SUCCESS;
}

HI_S32 PQ_HAL_SetHDRDefaultCfg(HI_BOOL bDefault)
{
    if (bDefault == HI_FALSE)
    {
        PQ_MNG_ScrambleHdrCfg(PQ_HDR_ALG_CFG_TYPE_TM);
    }
    else
    {
        pq_hal_SetHDRPqParamDefault();
    }

    return HI_SUCCESS;
}


